---
title: Archiviare i risultati dell'analisi di valutazione della vulnerabilità in un account di archiviazione accessibile dietro i firewall e reti virtuali
description: Fornisce istruzioni su come archiviare le analisi di valutazione della vulnerabilità in un account di archiviazione a cui è possibile accedere tramite un firewall o un VNet
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.topic: how-to
author: barmichal
ms.author: mibar
ms.reviewer: vanto
ms.date: 12/01/2020
ms.openlocfilehash: d6f42df0858042f569b459c43a80ce6b062cee9f
ms.sourcegitcommit: 6a350f39e2f04500ecb7235f5d88682eb4910ae8
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/01/2020
ms.locfileid: "96454092"
---
# <a name="store-vulnerability-assessment-scan-results-in-a-storage-account-accessible-behind-firewalls-and-vnets"></a>Archiviare i risultati dell'analisi di valutazione della vulnerabilità in un account di archiviazione accessibile dietro i firewall e reti virtuali
[!INCLUDE[appliesto-sqldb-sqlmi](../includes/appliesto-sqldb-sqlmi.md)]

Se si limita l'accesso all'account di archiviazione in Azure per determinati reti virtuali o servizi, è necessario abilitare la configurazione appropriata in modo che l'analisi della vulnerabilità (VA) per i database SQL o le istanze gestite abbia accesso a tale account di archiviazione.

## <a name="enable-azure-sql-database-va-scanning-access-to-the-storage-account"></a>Abilitare l'analisi del database SQL di Azure per l'accesso all'account di archiviazione

Se l'account di archiviazione VA è stato configurato in modo da essere accessibile solo da determinate reti o servizi, è necessario assicurarsi che le analisi di VA per il database SQL di Azure siano in grado di archiviare le analisi nell'account di archiviazione. Per individuare l'account di archiviazione in uso, passare al riquadro di **SQL Server** nel [portale di Azure](https://portal.azure.com), in **sicurezza**, selezionare **Centro sicurezza**.

:::image type="content" source="../database/media/azure-defender-for-sql/va-storage.png" alt-text="configurare la valutazione della vulnerabilità":::

È possibile usare l'account di archiviazione esistente o creare un nuovo account di archiviazione per archiviare i risultati dell'analisi VA per tutti i database nel [server SQL logico](logical-servers.md).

Passare al **gruppo di risorse** che contiene l'account di archiviazione e accedere al riquadro **account di archiviazione** . In **Impostazioni** selezionare **firewall e reti virtuali**.

Assicurarsi che **l'opzione Consenti accesso ai servizi Microsoft attendibili a questo account di archiviazione** sia selezionata.

:::image type="content" source="media/sql-database-vulnerability-assessment-storage/storage-allow-microsoft-services.png" alt-text="Screenshot mostra la finestra di dialogo firewall e reti virtuali, con Consenti ai servizi Microsoft attendibili di accedere a questo account di archiviazione selezionato.":::

## <a name="store-va-scan-results-for-azure-sql-managed-instance-in-a-storage-account-that-can-be-accessed-behind-a-firewall-or-vnet"></a>Archiviare i risultati dell'analisi per Azure SQL Istanza gestita in un account di archiviazione a cui è possibile accedere dietro un firewall o VNet

Poiché Istanza gestita non è un servizio Microsoft attendibile e ha un VNet diverso rispetto all'account di archiviazione, l'esecuzione di un'analisi di VA genera un errore.

Per supportare le analisi di VA sulle istanze gestite, attenersi alla procedura seguente:

1. Nel riquadro **istanza gestita di SQL** , sotto l'intestazione **Panoramica** , fare clic sul collegamento **rete virtuale/subnet** . Verrà quindi riportato al riquadro **rete virtuale** .

   :::image type="content" source="../managed-instance/media/public-endpoint-configure/mi-overview.png" alt-text="mi-overview2":::

1. In **Impostazioni** selezionare **Subnet**. Fare clic su **subnet** nel nuovo riquadro per aggiungere una subnet e delegarla a *Microsoft. sql\managedInstance*. Per ulteriori informazioni, vedere [Manage Subnets](../../virtual-network/virtual-network-manage-subnet.md).

   :::image type="content" source="media/sql-database-vulnerability-assessment-storage/mi-subnets.png" alt-text="Screenshot mostra una subnet delegata Microsoft. sql\managedInstance.":::

1. Nel riquadro **rete virtuale** , in **Impostazioni**, selezionare **endpoint servizio**. Fare clic su **Aggiungi** nel nuovo riquadro e aggiungere il servizio *Microsoft. storage* come nuovo endpoint di servizio. Verificare che la subnet *ManagedInstance* sia selezionata. Scegliere **Aggiungi**.

   :::image type="content" source="media/sql-database-vulnerability-assessment-storage/mi-service-endpoint.png" alt-text="Screenshot mostra aggiungere gli endpoint del servizio, in cui è possibile aggiungere il servizio Microsoft. storage come endpoint.":::

1. Passare all' **account di archiviazione** selezionato per archiviare le analisi di va. In **Impostazioni** selezionare **firewall e reti virtuali**. Fare clic su **Aggiungi rete virtuale esistente**. Selezionare la rete virtuale dell'istanza gestita e la subnet, quindi fare clic su **Aggiungi**.

   :::image type="content" source="media/sql-database-vulnerability-assessment-storage/storage-firewall.png" alt-text="Screenshot mostra il riquadro Firewall e reti virtuali, che contiene il collegamento Aggiungi rete virtuale esistente.":::

A questo punto dovrebbe essere possibile archiviare le analisi di VA per le istanze gestite nell'account di archiviazione.

## <a name="next-steps"></a>Passaggi successivi

- [Valutazione della vulnerabilità](sql-vulnerability-assessment.md)
- [Creare un account di archiviazione di Azure](../../storage/common/storage-account-create.md)
- [Azure Defender per SQL](azure-defender-for-sql.md)